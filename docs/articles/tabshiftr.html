<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tabshiftr - Reshape disorganised messy data • tabshiftr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="tabshiftr - Reshape disorganised messy data">
<meta property="og:description" content="tabshiftr">
<meta property="og:image" content="http://EhrmannS.github.io/tabshiftr/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tabshiftr</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/tabshiftr.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://www.twitter.com/DerEhrmann">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/EhrmannS/tabshiftr">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="tabshiftr_files/header-attrs-2.3/header-attrs.js"></script><script src="tabshiftr_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>tabshiftr - Reshape disorganised messy data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/EhrmannS/tabshiftr/blob/master/vignettes/tabshiftr.Rmd"><code>vignettes/tabshiftr.Rmd</code></a></small>
      <div class="hidden name"><code>tabshiftr.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Spreadsheets as places where data tables are recorded can be pretty messy. The ‘tidy’ paradigm in R proposes that data are organised so that variables are recorded in columns, observations in rows and that there is only one value per cell <span class="citation">(Wickham <a href="#ref-Wickham2014" role="doc-biblioref">2014</a>)</span>. This, however, is only one interpretation of how data should be organised and especially when scraping data from multiple heterogeneous sources off the internet, one frequently encounters messy data that don’t follow this paradigm.</p>
<p>The <code>tidyr</code> package is one of the most popular tools to bring data into a tidy format. However, up until today it is limited to tables that are already organised into topologically coherent (rectangular) chunks. In <code>tabshiftr</code> we try to describe and work with a further dimension of messiness, where data are available as so-called <em>disorganised (messy) data</em>, data that are not yet arranged into rectangular form.</p>
<div id="the-basics" class="section level2">
<h2 class="hasAnchor">
<a href="#the-basics" class="anchor"></a>The basics</h2>
<p>Data can be disorganised according to multiple dimensions. To understand those dimensions, we first need to understand the nature of data. Data "of the same kind" are collected in a variable, which is always a combination of a 'name' and the 'values'. In a table, names are typically in the topmost row and values are in the column below that name (<a href="#tabExample">Tab. 1</a>). Conceptually, there are two types of variables in any dataset:</p>
<ol style="list-style-type: decimal">
<li>Variables that contain categorical levels that identify the units for which values have been observed (they are called <em>identifying variables</em> here).</li>
<li>Variables that have been measured or observed and that consequently represent the target values of that measurement, be they continuous or categorical (they are called <em>observed variables</em> here).</li>
</ol>
<table class="table">
<caption>
<a name="tabExample"></a>Table 1: An example table containing one identifying and two observed variables, with the variable names in the topmost row and the values in all consecutive rows.</caption>
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th align="left">identifying variable</th>
<th align="left">observed variable (continuous)</th>
<th align="left">observed variable (categorical)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">sample 1</td>
<td align="left">10</td>
<td align="left">blue</td>
</tr>
<tr class="even">
<td align="left">sample 2</td>
<td align="left">20</td>
<td align="left">black</td>
</tr>
<tr class="odd">
<td align="left">sample 3</td>
<td align="left">30</td>
<td align="left">white</td>
</tr>
</tbody>
</table>
</div>
<div id="dimensions-of-disorganisation" class="section level2">
<h2 class="hasAnchor">
<a href="#dimensions-of-disorganisation" class="anchor"></a>Dimensions of disorganisation</h2>
<p>The following lists the dimensions of how data can be disorganised, several of which can co-occur in one table.</p>
<ol style="list-style-type: decimal">
<li>Each level of an identifying variable, or the different values of a categorical observed variable are organised into separate topologically coherent chunks (clusters) of data, instead of all variables in one cluster/table.</li>
<li>The names of observed variables are treated as if they were the levels of an identifying variable (they are <em>listed</em>), instead of each observed variable in its own column. This is also called "long" data.</li>
<li>The levels of one or more identifying variable are spread over several columns, instead of all levels in only one column. This is also called "wide" data.</li>
<li>Several identifying variables are stored in the same column or one identifying variable is split up into several columns.</li>
<li>One or more variables are stored in a spreadsheet so that the resulting table is topologically non-coherent.</li>
<li>One or more variables are merely implicitly available (e.g., as spreadsheet or file name)</li>
</ol>
</div>
<div id="schema-descriptions" class="section level2">
<h2 class="hasAnchor">
<a href="#schema-descriptions" class="anchor"></a>Schema descriptions</h2>
<p>The approach of <code>tabshiftr</code> is based on capturing the arrangement of a table in a so-called <a href="https://en.wikipedia.org/wiki/Database_schema">schema</a> description. Typically there is an input and an output schema, describing the arrangement of the input and output tables, respectively. The advantage of this procedure is that input and output tables exist explicitly and the schema maps the transformation of the data. As we want to end up with tidy tables the output schema is pre-determined by a tidy table of the included variables, but the input schema description needs to be provided by the user.</p>
<p>To set up a schema description, the following steps should be taken:</p>
<ol style="list-style-type: decimal">
<li><p>Clarify which are the identifying variables and which are the observed variables. Make sure not to mistake a listed observed variable as identifying variable.</p></li>
<li><p>Determine whether there are clusters, find the origin (top left cell) of each cluster and provide the required information in <code><a href="../reference/setCluster.html">setCluster()</a></code> (<a href="#clusHor">Tab. 9</a>, <a href="#clusId">Tab. 10</a> &amp; <a href="#clusMeas">Tab. 11</a>). It might make sense to treat a table that does not start at the topmost left cell as cluster (<a href="#implicitVar">Tab. 6</a>). Follow the next steps for each cluster…</p></li>
<li>
<p>Determine which variable identifies clusters and specify that as identifying variable. It can also be the case that the data are organised into separate spreadsheets or files according to one of the variables and also those cases should be treated as if they were clusters, even if each spreadsheet/file contains a topologically coherent table. It may be that either an identifying variable, or a observed variable identifies clusters:</p>
<ul>
<li>in case it is an identifying variable, provide its name in <code><a href="../reference/setCluster.html">setCluster(id = ...)</a></code> and specify it as an identifying variable (<code><a href="../reference/setIDVar.html">setIDVar()</a></code>)</li>
<li>in case it is a observed variable, provide simply <code>"observed"</code> as cluster ID. <br><br>
</li>
</ul>
</li>
<li>
<p>Determine for each identifying variable the following:</p>
<ul>
<li>is the variable available at all? This is particularly important when the data are split up into sub-tables that are in different spreadsheets or files. Often the variable that splits up the data (and thus identifies the clusters) is not explicitly available in the spreadsheet anymore. In such a case, provide the value in <code><a href="../reference/setIDVar.html">setIDVar(value = ...)</a></code> (<a href="#implicitVar">Tab. 6</a>).</li>
<li>all columns in which the variable values sit.</li>
<li>in case the variable is in several columns, determine additionally the row in which its values sit. In this case, the values will look like they are part of the header (<a href="#nest2">Tab. 4</a>).</li>
<li>in case the variable must be split off of another column, provide a regular expression that results in the target subset via <code><a href="../reference/setIDVar.html">setIDVar(split = ...)</a></code> (<a href="#splitCol">Tab. 5</a>).</li>
<li>in case the variable is distinct from the main table, provide the explicit (non-relative) position and set <code><a href="../reference/setIDVar.html">setIDVar(distinct = TRUE)</a></code> (<a href="#distVar">Tab. 12</a>). <br><br>
</li>
</ul>
</li>
<li>
<p>Determine for each observed variable the following:</p>
<ul>
<li>all columns in which the values of the variable sit (<a href="#long">Tab. 7</a>).</li>
<li>the unit and conversion factor.</li>
<li>in case the variable is not tidy, go through the following cases step by step:
<ul>
<li>in case the variable is nested in a wide identifying variable, determine in addition to the columns in which the values sit also the rows in which the <strong>variable name</strong> sits (<a href="#nest1">Tab. 3</a> &amp; <a href="#nest2">Tab. 4</a>).</li>
<li>in case the names of the variable are given as a value of an identifying variable (<a href="#wideLong">Tab. 8</a>), give the column number as <code>key</code>, together with the name of the respective observed variable (as it appears in the table) in <code>values</code>.</li>
<li>in case the name of the variable is the ID of clusters, specify <code>key = "cluster"</code> and in <code>values</code> the cluster number the variable refers to (<a href="#clusMeas">Tab. 11</a>). <br><br>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Provide potentially information about the table header (<code><a href="../reference/setHeader.html">setHeader()</a></code>) and format (<code><a href="../reference/setFormat.html">setFormat()</a></code>).</p></li>
</ol>
</div>
</div>
<div id="table-types" class="section level1">
<h1 class="hasAnchor">
<a href="#table-types" class="anchor"></a>Table types</h1>
<p>The following sections are organised according to the dimensions of disorganisation outlined above, first introducing the problem more in detail and then giving a description of some typical table arrangements, followed by a schema description that can be used for their reorganisation. This is certainly not an exhaustive list of possible table arrangements, but it covers certain basic building blocks of the most common operations and should be extensible enough to capture many mutations of the presented tables.</p>
<p>Ideally, we read in tables while treating any header rows <em>as data</em>, i.e., by not setting the first row as header. This makes sense, because in disorganised tables it’s often not only the first row that is part of the header.</p>
<div id="spreadsheet-contains-one-cluster" class="section level2">
<h2 class="hasAnchor">
<a href="#spreadsheet-contains-one-cluster" class="anchor"></a>Spreadsheet contains one cluster</h2>
<div id="separated-observed-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#separated-observed-variables" class="anchor"></a>Separated <em>observed variables</em>
</h3>
<p>In case the observed variables are arranged into individual columns (<a href="#tab1">Tab. 2</a>), we have tidy data <span class="citation">(Wickham <a href="#ref-Wickham2014" role="doc-biblioref">2014</a>)</span>, which are already in the target arrangement. The variables in a tidy table may however, still need different names, units and transformation factors.</p>
<table class="table">
<caption>
<a name="tab1"></a>Table 2: A tidy table.</caption>
<thead><tr class="header">
<th align="left">X1</th>
<th align="left">X2</th>
<th align="left">X3</th>
<th align="left">X4</th>
<th align="left">X5</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">territories</td>
<td align="left">period</td>
<td align="left">commodities</td>
<td align="left">harvested</td>
<td align="left">production</td>
</tr>
<tr class="even">
<td align="left">unit 1</td>
<td align="left">year 1</td>
<td align="left">soybean</td>
<td align="left">1111</td>
<td align="left">1112</td>
</tr>
<tr class="odd">
<td align="left">unit 1</td>
<td align="left">year 1</td>
<td align="left">maize</td>
<td align="left">1121</td>
<td align="left">1122</td>
</tr>
<tr class="even">
<td align="left">unit 1</td>
<td align="left">year 2</td>
<td align="left">soybean</td>
<td align="left">1211</td>
<td align="left">1212</td>
</tr>
<tr class="odd">
<td align="left">unit 1</td>
<td align="left">year 2</td>
<td align="left">maize</td>
<td align="left">1221</td>
<td align="left">1222</td>
</tr>
<tr class="even">
<td align="left">unit 2</td>
<td align="left">year 1</td>
<td align="left">soybean</td>
<td align="left">2111</td>
<td align="left">2112</td>
</tr>
<tr class="odd">
<td align="left">unit 2</td>
<td align="left">year 1</td>
<td align="left">maize</td>
<td align="left">2121</td>
<td align="left">2122</td>
</tr>
<tr class="even">
<td align="left">unit 2</td>
<td align="left">year 2</td>
<td align="left">soybean</td>
<td align="left">2211</td>
<td align="left">2212</td>
</tr>
<tr class="odd">
<td align="left">unit 2</td>
<td align="left">year 2</td>
<td align="left">maize</td>
<td align="left">2221</td>
<td align="left">2222</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">schema</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/setHeader.html">setHeader</a></span>(<span class="kw">rows</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"territories"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"year"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"commodities"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">3</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"harvested"</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"ha"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">4</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"production"</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"t"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">5</span>)</pre></body></html></div>
<p>In case identifying variables are factors with a small number of levels, those levels may falsely be used as names of (some) other variables, where they would be next to each other and thus "wide". The other variables (both identifying and observed variables) would then be "nested" in those wide identifying variables. In those cases we have to record the columns <strong>and the row</strong> in which the values of the identifying variable (which appear to be names) are found. Beware that in those cases you also need to adapt the header specification, so that this row is excluded from the respective nested variable.</p>
<table class="table">
<caption>
<a name="nest1"></a>Table 3: The values variables are nested within the identifying variable <code>commodities</code>.</caption>
<thead><tr class="header">
<th align="left">X1</th>
<th align="left">X2</th>
<th align="left">X3</th>
<th align="left">X4</th>
<th align="left">X5</th>
<th align="left">X6</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">territories</td>
<td align="left">period</td>
<td align="left">soybean</td>
<td align="left"></td>
<td align="left">maize</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">harvested</td>
<td align="left">production</td>
<td align="left">harvested</td>
<td align="left">production</td>
</tr>
<tr class="odd">
<td align="left">unit 1</td>
<td align="left">year 1</td>
<td align="left">1111</td>
<td align="left">1112</td>
<td align="left">1121</td>
<td align="left">1122</td>
</tr>
<tr class="even">
<td align="left">unit 1</td>
<td align="left">year 2</td>
<td align="left">1211</td>
<td align="left">1212</td>
<td align="left">1221</td>
<td align="left">1222</td>
</tr>
<tr class="odd">
<td align="left">unit 2</td>
<td align="left">year 1</td>
<td align="left">2111</td>
<td align="left">2112</td>
<td align="left">2112</td>
<td align="left">2122</td>
</tr>
<tr class="even">
<td align="left">unit 2</td>
<td align="left">year 2</td>
<td align="left">2211</td>
<td align="left">2212</td>
<td align="left">2121</td>
<td align="left">2222</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">schema</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/setHeader.html">setHeader</a></span>(<span class="kw">rows</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"territories"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"year"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"commodities"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">5</span>), <span class="kw">row</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"harvested"</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"ha"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">5</span>), <span class="kw">row</span> <span class="kw">=</span> <span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"production"</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"t"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">6</span>), <span class="kw">row</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p>In case several variables are nested within other variables, we have to specify for all nested or nesting variables in which rows their values sit and adapt the header.</p>
<table class="table">
<caption>
<a name="nest2"></a>Table 4: The identifying variable <code>commodities</code> is nested in the identifying variable <code>period</code>. The target variable is spread across those nested columns.</caption>
<colgroup>
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left">X1</th>
<th align="left">X2</th>
<th align="left">X3</th>
<th align="left">X4</th>
<th align="left">X5</th>
<th align="left">X6</th>
<th align="left">X7</th>
<th align="left">X8</th>
<th align="left">X9</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">territories</td>
<td align="left">year 1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">year 2</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">soybean</td>
<td align="left"></td>
<td align="left">maize</td>
<td align="left"></td>
<td align="left">soybean</td>
<td align="left"></td>
<td align="left">maize</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">harvested</td>
<td align="left">production</td>
<td align="left">harvested</td>
<td align="left">production</td>
<td align="left">harvested</td>
<td align="left">production</td>
<td align="left">harvested</td>
<td align="left">production</td>
</tr>
<tr class="even">
<td align="left">unit 1</td>
<td align="left">1111</td>
<td align="left">1112</td>
<td align="left">1121</td>
<td align="left">1122</td>
<td align="left">1211</td>
<td align="left">1212</td>
<td align="left">1221</td>
<td align="left">1222</td>
</tr>
<tr class="odd">
<td align="left">unit 2</td>
<td align="left">2111</td>
<td align="left">2211</td>
<td align="left">2121</td>
<td align="left">2221</td>
<td align="left">2112</td>
<td align="left">2212</td>
<td align="left">2122</td>
<td align="left">2222</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">schema</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/setHeader.html">setHeader</a></span>(<span class="kw">rows</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fl">3</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"territories"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"year"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">6</span>), <span class="kw">row</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"commodities"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span>), <span class="kw">row</span> <span class="kw">=</span> <span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"harvested"</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"ha"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span>), <span class="kw">row</span> <span class="kw">=</span> <span class="fl">3</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"production"</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"t"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">9</span>), <span class="kw">row</span> <span class="kw">=</span> <span class="fl">3</span>)</pre></body></html></div>
</div>
<div id="several-variables-in-one-column" class="section level3">
<h3 class="hasAnchor">
<a href="#several-variables-in-one-column" class="anchor"></a>Several variables in one column</h3>
<p>Sometimes it may be the case that several variables are stored in the same column, for example when a territorial unit is given together with the year of observation (e.g. <code>unit1, year1</code>). In those cases, the resulting variables in the output schema need to be specified so that they point to that same column but extract information via a regular expression (find more information <a href="https://edrub.in/CheatSheets/cheatSheetStringr.pdf">here</a>). For example, <code>.+?(?=_)</code> gives everything up until the first <code>_</code> and <code>(?&lt;=\\_).*</code> everything after the <code>_</code>.</p>
<table class="table">
<caption>
<a name="splitCol"></a>Table 5: The variables <code>year</code> and <code>commodities</code> are stored in the same column.</caption>
<thead><tr class="header">
<th align="left">X1</th>
<th align="left">X2</th>
<th align="left">X3</th>
<th align="left">X4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">territories</td>
<td align="left">unit</td>
<td align="left">harvested</td>
<td align="left">production</td>
</tr>
<tr class="even">
<td align="left">unit 1</td>
<td align="left">year 1_soybean</td>
<td align="left">1111</td>
<td align="left">1112</td>
</tr>
<tr class="odd">
<td align="left">unit 1</td>
<td align="left">year 1_maize</td>
<td align="left">1121</td>
<td align="left">1122</td>
</tr>
<tr class="even">
<td align="left">unit 1</td>
<td align="left">year 2_soybean</td>
<td align="left">1211</td>
<td align="left">1212</td>
</tr>
<tr class="odd">
<td align="left">unit 1</td>
<td align="left">year 2_maize</td>
<td align="left">1221</td>
<td align="left">1222</td>
</tr>
<tr class="even">
<td align="left">unit 2</td>
<td align="left">year 1_soybean</td>
<td align="left">2111</td>
<td align="left">2112</td>
</tr>
<tr class="odd">
<td align="left">unit 2</td>
<td align="left">year 1_maize</td>
<td align="left">2121</td>
<td align="left">2122</td>
</tr>
<tr class="even">
<td align="left">unit 2</td>
<td align="left">year 2_soybean</td>
<td align="left">2211</td>
<td align="left">2212</td>
</tr>
<tr class="odd">
<td align="left">unit 2</td>
<td align="left">year 2_maize</td>
<td align="left">2221</td>
<td align="left">2222</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">schema</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/setHeader.html">setHeader</a></span>(<span class="kw">rows</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"territories"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"year"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">split</span> <span class="kw">=</span> <span class="st">".+?(?=_)"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"commodities"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">split</span> <span class="kw">=</span> <span class="st">"(?&lt;=\\_).*"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"harvested"</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"ha"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">3</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"production"</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"t"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">4</span>)</pre></body></html></div>
</div>
<div id="implicit-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#implicit-variables" class="anchor"></a>Implicit variables</h3>
<p>When data are split up into clusters, the identifying variable is often recorded not in the table as an explicit variable, but is only provided in the file or spreadsheet name. In those cases, we have to register the variable nevertheless, and provide the value of that variable in <code>value =</code> of the identifying variable.</p>
<table class="table">
<caption>
<a name="implicitVar"></a>Table 6: The information about which territory we are dealing with is missing or implied by some meta-data.</caption>
<thead><tr class="header">
<th align="left">X1</th>
<th align="left">X2</th>
<th align="left">X3</th>
<th align="left">X4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">some metadata, which does not tell us that this is in fact unit 1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">commodities</td>
<td align="left">harvested</td>
<td align="left">production</td>
<td align="left">period</td>
</tr>
<tr class="odd">
<td align="left">soybean</td>
<td align="left">1111</td>
<td align="left">1112</td>
<td align="left">year 1</td>
</tr>
<tr class="even">
<td align="left">maize</td>
<td align="left">1121</td>
<td align="left">1122</td>
<td align="left">year 1</td>
</tr>
<tr class="odd">
<td align="left">soybean</td>
<td align="left">1211</td>
<td align="left">1212</td>
<td align="left">year 2</td>
</tr>
<tr class="even">
<td align="left">maize</td>
<td align="left">1221</td>
<td align="left">1222</td>
<td align="left">year 2</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">schema</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/setCluster.html">setCluster</a></span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"territories"</span>, <span class="kw">top</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">left</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setHeader.html">setHeader</a></span>(<span class="kw">rows</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">relative</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"territories"</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="st">"unit 1"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"year"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">relative</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"commodities"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">relative</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"harvested"</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"ha"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">relative</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"production"</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"t"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">relative</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
</div>
<div id="listed-observed-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#listed-observed-variables" class="anchor"></a>Listed <em>observed variables</em>
</h3>
<p>Some tables contain a column where the names of observed variables (<code>harvested</code> and <code>production</code>) are treated as if they were the values of an identifying variable (<code>dimension</code>), while the values are presented in only one column (<code>values</code>) (<a href="#long">Tab. 7</a>). To end up with tidy data in those cases, we need to extract the values associated with the observed variables. Thus, we define the observed variables and specify the <code>key =</code> in which the variable names sit, and the <code>value =</code> the variable name has, to extract that variable.</p>
<table class="table">
<caption>
<a name="long"></a>Table 7: The variable names of the observed variable are treated as if they were the values of the identifying variable <code>dimension</code>.</caption>
<thead><tr class="header">
<th align="left">X1</th>
<th align="left">X2</th>
<th align="left">X3</th>
<th align="left">X4</th>
<th align="left">X5</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">territories</td>
<td align="left">period</td>
<td align="left">commodities</td>
<td align="left">dimension</td>
<td align="left">values</td>
</tr>
<tr class="even">
<td align="left">unit 1</td>
<td align="left">year 1</td>
<td align="left">soybean</td>
<td align="left">harvested</td>
<td align="left">1111</td>
</tr>
<tr class="odd">
<td align="left">unit 1</td>
<td align="left">year 1</td>
<td align="left">maize</td>
<td align="left">harvested</td>
<td align="left">1121</td>
</tr>
<tr class="even">
<td align="left">unit 1</td>
<td align="left">year 1</td>
<td align="left">soybean</td>
<td align="left">production</td>
<td align="left">1112</td>
</tr>
<tr class="odd">
<td align="left">unit 1</td>
<td align="left">year 1</td>
<td align="left">maize</td>
<td align="left">production</td>
<td align="left">1122</td>
</tr>
<tr class="even">
<td align="left">unit 1</td>
<td align="left">year 2</td>
<td align="left">soybean</td>
<td align="left">harvested</td>
<td align="left">1211</td>
</tr>
<tr class="odd">
<td align="left">unit 1</td>
<td align="left">year 2</td>
<td align="left">maize</td>
<td align="left">harvested</td>
<td align="left">1221</td>
</tr>
<tr class="even">
<td align="left">unit 1</td>
<td align="left">year 2</td>
<td align="left">soybean</td>
<td align="left">production</td>
<td align="left">1212</td>
</tr>
<tr class="odd">
<td align="left">unit 1</td>
<td align="left">year 2</td>
<td align="left">maize</td>
<td align="left">production</td>
<td align="left">1222</td>
</tr>
<tr class="even">
<td align="left">unit 2</td>
<td align="left">year 1</td>
<td align="left">soybean</td>
<td align="left">harvested</td>
<td align="left">2111</td>
</tr>
<tr class="odd">
<td align="left">unit 2</td>
<td align="left">year 1</td>
<td align="left">maize</td>
<td align="left">harvested</td>
<td align="left">2121</td>
</tr>
<tr class="even">
<td align="left">unit 2</td>
<td align="left">year 1</td>
<td align="left">soybean</td>
<td align="left">production</td>
<td align="left">2112</td>
</tr>
<tr class="odd">
<td align="left">unit 2</td>
<td align="left">year 1</td>
<td align="left">maize</td>
<td align="left">production</td>
<td align="left">2122</td>
</tr>
<tr class="even">
<td align="left">unit 2</td>
<td align="left">year 2</td>
<td align="left">soybean</td>
<td align="left">harvested</td>
<td align="left">2211</td>
</tr>
<tr class="odd">
<td align="left">unit 2</td>
<td align="left">year 2</td>
<td align="left">maize</td>
<td align="left">harvested</td>
<td align="left">2221</td>
</tr>
<tr class="even">
<td align="left">unit 2</td>
<td align="left">year 2</td>
<td align="left">soybean</td>
<td align="left">production</td>
<td align="left">2212</td>
</tr>
<tr class="odd">
<td align="left">unit 2</td>
<td align="left">year 2</td>
<td align="left">maize</td>
<td align="left">production</td>
<td align="left">2222</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">schema</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/setHeader.html">setHeader</a></span>(<span class="kw">rows</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"territories"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"year"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"commodities"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">3</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"harvested"</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"ha"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">5</span>,
            <span class="kw">key</span> <span class="kw">=</span> <span class="st">"dimension"</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="st">"harvested"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"production"</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"t"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">5</span>,
            <span class="kw">key</span> <span class="kw">=</span> <span class="st">"dimension"</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="st">"production"</span>)</pre></body></html></div>
<p>Moreover, (several) identifying variables may be wide additionally and we have to proceed as mentioned above, by providing the row and columns of the wide identifying variables.</p>
<table class="table">
<caption>
<a name="wideLong"></a>Table 8: The identifying variable <code>commodities</code> is treated as if it were the observed variables while the variable names of the observed variable are treated as if they were the values of the identifying variable <code>dimension</code>.</caption>
<thead><tr class="header">
<th align="left">X1</th>
<th align="left">X2</th>
<th align="left">X3</th>
<th align="left">X4</th>
<th align="left">X5</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">territories</td>
<td align="left">period</td>
<td align="left">dimension</td>
<td align="left">soybean</td>
<td align="left">maize</td>
</tr>
<tr class="even">
<td align="left">unit 1</td>
<td align="left">year 1</td>
<td align="left">harvested</td>
<td align="left">1111</td>
<td align="left">1121</td>
</tr>
<tr class="odd">
<td align="left">unit 1</td>
<td align="left">year 1</td>
<td align="left">production</td>
<td align="left">1112</td>
<td align="left">1122</td>
</tr>
<tr class="even">
<td align="left">unit 1</td>
<td align="left">year 2</td>
<td align="left">harvested</td>
<td align="left">1211</td>
<td align="left">1221</td>
</tr>
<tr class="odd">
<td align="left">unit 1</td>
<td align="left">year 2</td>
<td align="left">production</td>
<td align="left">1212</td>
<td align="left">1222</td>
</tr>
<tr class="even">
<td align="left">unit 2</td>
<td align="left">year 1</td>
<td align="left">harvested</td>
<td align="left">2111</td>
<td align="left">2121</td>
</tr>
<tr class="odd">
<td align="left">unit 2</td>
<td align="left">year 1</td>
<td align="left">production</td>
<td align="left">2112</td>
<td align="left">2122</td>
</tr>
<tr class="even">
<td align="left">unit 2</td>
<td align="left">year 2</td>
<td align="left">harvested</td>
<td align="left">2211</td>
<td align="left">2221</td>
</tr>
<tr class="odd">
<td align="left">unit 2</td>
<td align="left">year 2</td>
<td align="left">production</td>
<td align="left">2212</td>
<td align="left">2222</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">schema</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/setHeader.html">setHeader</a></span>(<span class="kw">rows</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"territories"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"year"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">2</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"commodities"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">5</span>), <span class="kw">row</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"harvested"</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"ha"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">5</span>),
              <span class="kw">key</span> <span class="kw">=</span> <span class="st">"dimension"</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="st">"harvested"</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"production"</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"t"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">5</span>),
              <span class="kw">key</span> <span class="kw">=</span> <span class="st">"dimension"</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="st">"production"</span>)</pre></body></html></div>
</div>
</div>
<div id="spreadsheet-contains-several-clusters" class="section level2">
<h2 class="hasAnchor">
<a href="#spreadsheet-contains-several-clusters" class="anchor"></a>Spreadsheet contains several clusters</h2>
<p>Clusters are often of the same arrangement within one spreadsheet, they can be repeated along rows (horizontally) or along columns (vertically). A table should be treated like a cluster also when the spreadsheet contains not only the table, but perhaps also text that may be scattered across the document and that does not allow the table to start at the spreadsheet origin in the topmost left cell.</p>
<p>To reorganise those data into tidy form, each cluster is "cut out", rearranged individually and appended to the end of an output table by <code><a href="../reference/reorganise.html">reorganise()</a></code>.</p>
<div id="horizontal-clusters" class="section level3">
<h3 class="hasAnchor">
<a href="#horizontal-clusters" class="anchor"></a>Horizontal clusters</h3>
<p>In case clusters are sitting right next to each other in the same origin row (<a href="#clusHor">Tab. 9</a>), it is sufficient to provide the topmost row and all leftmost columns at which a new cluster starts. In case there is some arbitrary horizontal space between clusters, also the width (of each cluster) needs to be provided.</p>
<table class="table">
<caption>
<a name="clusHor"></a>Table 9: Horizontal clusters of the identifying variable <code>period</code>.</caption>
<thead><tr class="header">
<th align="left">X1</th>
<th align="left">X2</th>
<th align="left">X3</th>
<th align="left">X4</th>
<th align="left">X5</th>
<th align="left">X6</th>
<th align="left">X7</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">period</td>
<td align="left">commodities</td>
<td align="left">harvested</td>
<td align="left">production</td>
<td align="left">commodities</td>
<td align="left">harvested</td>
<td align="left">production</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">unit 1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">unit 2</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">year 1</td>
<td align="left">soybean</td>
<td align="left">1111</td>
<td align="left">1112</td>
<td align="left">soybean</td>
<td align="left">2111</td>
<td align="left">2112</td>
</tr>
<tr class="even">
<td align="left">year 1</td>
<td align="left">maize</td>
<td align="left">1121</td>
<td align="left">1122</td>
<td align="left">maize</td>
<td align="left">2121</td>
<td align="left">2122</td>
</tr>
<tr class="odd">
<td align="left">year 2</td>
<td align="left">soybean</td>
<td align="left">1211</td>
<td align="left">1212</td>
<td align="left">soybean</td>
<td align="left">2211</td>
<td align="left">2212</td>
</tr>
<tr class="even">
<td align="left">year 2</td>
<td align="left">maize</td>
<td align="left">1221</td>
<td align="left">1222</td>
<td align="left">maize</td>
<td align="left">2221</td>
<td align="left">2222</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">schema</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/setCluster.html">setCluster</a></span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"territories"</span>, <span class="kw">left</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">5</span>), <span class="kw">top</span> <span class="kw">=</span> <span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setHeader.html">setHeader</a></span>(<span class="kw">rows</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"territories"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">5</span>), <span class="kw">row</span> <span class="kw">=</span> <span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"year"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"commodities"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">5</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"harvested"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">6</span>), <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"ha"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"production"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">7</span>), <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"t"</span>)</pre></body></html></div>
</div>
<div id="vertical-clusters" class="section level3">
<h3 class="hasAnchor">
<a href="#vertical-clusters" class="anchor"></a>Vertical clusters</h3>
<p>For vertically arranged clusters (<a href="#clusId">Tab. 10</a>), just like for the horizontal case, the respective rows, columns (and heights) need to be provided.</p>
<table class="table">
<caption>
<a name="clusId"></a>Table 10: Vertical clusters of the identifying variable <code>period</code>.</caption>
<thead><tr class="header">
<th align="left">X1</th>
<th align="left">X2</th>
<th align="left">X3</th>
<th align="left">X4</th>
<th align="left">X5</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">territories</td>
<td align="left">period</td>
<td align="left">commodities</td>
<td align="left">harvested</td>
<td align="left">production</td>
</tr>
<tr class="even">
<td align="left">unit 1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">year 1</td>
<td align="left">soybean</td>
<td align="left">1111</td>
<td align="left">1112</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">year 1</td>
<td align="left">maize</td>
<td align="left">1121</td>
<td align="left">1122</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">year 2</td>
<td align="left">soybean</td>
<td align="left">1211</td>
<td align="left">1212</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">year 2</td>
<td align="left">maize</td>
<td align="left">1221</td>
<td align="left">1222</td>
</tr>
<tr class="odd">
<td align="left">unit 2</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">year 1</td>
<td align="left">soybean</td>
<td align="left">2111</td>
<td align="left">2112</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">year 1</td>
<td align="left">maize</td>
<td align="left">2121</td>
<td align="left">2122</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">year 2</td>
<td align="left">soybean</td>
<td align="left">2211</td>
<td align="left">2212</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">year 2</td>
<td align="left">maize</td>
<td align="left">2221</td>
<td align="left">2222</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">schema</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/setCluster.html">setCluster</a></span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"territories"</span>, <span class="kw">top</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">8</span>), <span class="kw">left</span> <span class="kw">=</span> <span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setHeader.html">setHeader</a></span>(<span class="kw">rows</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"territories"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">row</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">7</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"year"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"commodities"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">3</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"harvested"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"ha"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"production"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"t"</span>)</pre></body></html></div>
</div>
<div id="messy-clusters" class="section level3">
<h3 class="hasAnchor">
<a href="#messy-clusters" class="anchor"></a>Messy clusters</h3>
<p>In case several clusters are neither aligned along a row nor a column, and are all of differing size, the respective information need to be provided at the same index of the respective property. For example, three clusters, where the first cluster starts at (1,1) and is 3 by 4 cells in size, where the second clusters starts at (5,2) and is 5 by 5 cells in size, and so on, needs to be specified as below.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">schema</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/setCluster.html">setCluster</a></span>(<span class="kw">top</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">1</span>), <span class="kw">left</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span>),
                     <span class="kw">width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">2</span>), <span class="kw">height</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">3</span>), <span class="kw">id</span> <span class="kw">=</span> <span class="no">...</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setHeader.html">setHeader</a></span>(<span class="kw">rows</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"territories"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">relative</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="no">...</span></pre></body></html></div>
<p>Additionally, given that at least the tables within each cluster are all arranged in the same way, the contained variables can be specified so that their row and column indices are given relative to the cluster position (<code>relative = TRUE</code>). If also that is not the case, the row and column values for each cluster need to be provided for the respective variables in the same way as for cluster positions.</p>
</div>
<div id="clusters-of-observed-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#clusters-of-observed-variables" class="anchor"></a>Clusters of observed variables</h3>
<p>The previous two types of clusters are clusters of identifying variables, but it may also be the case that the observed variables are split up into distinct clusters. Here, we need to specify first of all in <code>clusters</code> <code>"id = "observed"</code> to indicate that the observed variable is the cluster ID. Next, we need to set up the observed variables so that they contain <code>"key = "cluster"</code> and in <code>value</code> the number of the cluster this variable can be found in. Moreover, we provide the column(s) and all rows that contain the values of each observed variable. This is in contrast to nested observed variables, where the rows of the variable names need to be provided.</p>
<table class="table">
<caption>
<a name="clusMeas"></a>Table 11: Vertical clusters of the observed variables.</caption>
<thead><tr class="header">
<th align="left">X1</th>
<th align="left">X2</th>
<th align="left">X3</th>
<th align="left">X4</th>
<th align="left">X5</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left">territories</td>
<td align="left">period</td>
<td align="left">commodities</td>
<td align="left">values</td>
</tr>
<tr class="even">
<td align="left">harvested</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">unit 1</td>
<td align="left">year 1</td>
<td align="left">soybean</td>
<td align="left">1111</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">unit 1</td>
<td align="left">year 1</td>
<td align="left">maize</td>
<td align="left">1121</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">unit 1</td>
<td align="left">year 2</td>
<td align="left">soybean</td>
<td align="left">1211</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">unit 1</td>
<td align="left">year 2</td>
<td align="left">maize</td>
<td align="left">1221</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">unit 2</td>
<td align="left">year 1</td>
<td align="left">soybean</td>
<td align="left">2111</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">unit 2</td>
<td align="left">year 1</td>
<td align="left">maize</td>
<td align="left">2121</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">unit 2</td>
<td align="left">year 2</td>
<td align="left">soybean</td>
<td align="left">2211</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">unit 2</td>
<td align="left">year 2</td>
<td align="left">maize</td>
<td align="left">2221</td>
</tr>
<tr class="odd">
<td align="left">production</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">unit 1</td>
<td align="left">year 1</td>
<td align="left">soybean</td>
<td align="left">1112</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">unit 1</td>
<td align="left">year 1</td>
<td align="left">maize</td>
<td align="left">1122</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">unit 1</td>
<td align="left">year 2</td>
<td align="left">soybean</td>
<td align="left">1212</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">unit 1</td>
<td align="left">year 2</td>
<td align="left">maize</td>
<td align="left">1222</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">unit 2</td>
<td align="left">year 1</td>
<td align="left">soybean</td>
<td align="left">2112</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">unit 2</td>
<td align="left">year 1</td>
<td align="left">maize</td>
<td align="left">2122</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">unit 2</td>
<td align="left">year 2</td>
<td align="left">soybean</td>
<td align="left">2212</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">unit 2</td>
<td align="left">year 2</td>
<td align="left">maize</td>
<td align="left">2222</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">schema</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/setCluster.html">setCluster</a></span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"observed"</span>, <span class="kw">left</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">top</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">12</span>), <span class="kw">height</span> <span class="kw">=</span> <span class="fl">8</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setHeader.html">setHeader</a></span>(<span class="kw">rows</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"territories"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"year"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">3</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"commodities"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">4</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"harvested"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"ha"</span>,
            <span class="kw">key</span> <span class="kw">=</span> <span class="st">"cluster"</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"production"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"t"</span>,
            <span class="kw">key</span> <span class="kw">=</span> <span class="st">"cluster"</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
</div>
<div id="variables-that-are-distinct-from-a-cluster" class="section level3">
<h3 class="hasAnchor">
<a href="#variables-that-are-distinct-from-a-cluster" class="anchor"></a>Variables that are distinct from a cluster</h3>
<p>When not all identifying variables can be provided relative to the cluster origin, for example because they are missing for some clusters, it makes more sense to define such a variable as a distinct variable. This is done by providing <code>row</code> and <code>col</code> as absolute values and setting <code>distinct = TRUE</code>. Other variables that are all arranged in the same way in each cluster can be specified so that their row and column indices are given relative to the cluster position (<code>relative = TRUE</code>).</p>
<table class="table">
<caption>
<a name="distVar"></a>Table 12: Several clusters where one variable is not available for each cluster, but distinct of them.</caption>
<thead><tr class="header">
<th align="left">X1</th>
<th align="left">X2</th>
<th align="left">X3</th>
<th align="left">X4</th>
<th align="left">X5</th>
<th align="left">X6</th>
<th align="left">X7</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">commodities</td>
<td align="left">harvested</td>
<td align="left">production</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">unit 1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">soybean</td>
<td align="left">1111</td>
<td align="left">1112</td>
<td align="left">year 1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">maize</td>
<td align="left">1121</td>
<td align="left">1122</td>
<td align="left">year 1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">soybean</td>
<td align="left">1211</td>
<td align="left">1212</td>
<td align="left">year 2</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">maize</td>
<td align="left">1221</td>
<td align="left">1222</td>
<td align="left">year 2</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">commodities</td>
<td align="left">harvested</td>
<td align="left">production</td>
<td align="left">commodities</td>
<td align="left">harvested</td>
<td align="left">production</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">unit 2</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">unit 3</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">soybean</td>
<td align="left">2111</td>
<td align="left">2112</td>
<td align="left">soybean</td>
<td align="left">3111</td>
<td align="left">3112</td>
<td align="left">year 1</td>
</tr>
<tr class="odd">
<td align="left">maize</td>
<td align="left">2121</td>
<td align="left">2122</td>
<td align="left">maize</td>
<td align="left">3121</td>
<td align="left">3122</td>
<td align="left">year 1</td>
</tr>
<tr class="even">
<td align="left">soybean</td>
<td align="left">2211</td>
<td align="left">2212</td>
<td align="left">soybean</td>
<td align="left">3211</td>
<td align="left">3212</td>
<td align="left">year 2</td>
</tr>
<tr class="odd">
<td align="left">maize</td>
<td align="left">2221</td>
<td align="left">2222</td>
<td align="left">maize</td>
<td align="left">3221</td>
<td align="left">3222</td>
<td align="left">year 2</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">schema</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/setCluster.html">setCluster</a></span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"territories"</span>, <span class="kw">top</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">8</span>), <span class="kw">left</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>),
                     <span class="kw">width</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">6</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setHeader.html">setHeader</a></span>(<span class="kw">rows</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">relative</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"territories"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">row</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">relative</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"year"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">row</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>:<span class="fl">6</span>), <span class="kw">distinct</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setIDVar.html">setIDVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"commodities"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">relative</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"harvested"</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"ha"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">relative</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/setObsVar.html">setObsVar</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">"production"</span>, <span class="kw">unit</span> <span class="kw">=</span> <span class="st">"t"</span>, <span class="kw">columns</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">relative</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
</div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references hanging-indent">
<div id="ref-Wickham2014">
<p>Wickham, Hadley. 2014. “Tidy Data.” <em>Journal of Statistical Software</em> 59 (10): 1–23. <a href="https://doi.org/10.18637/jss.v059.i10">https://doi.org/10.18637/jss.v059.i10</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://orcid.org/0000-0002-2958-0796">Steffen Ehrmann</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
